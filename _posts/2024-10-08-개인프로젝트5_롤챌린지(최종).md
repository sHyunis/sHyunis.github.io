---
title: "ê°œì¸í”„ë¡œì íŠ¸5_ë¡¤ì±Œë¦°ì§€ì†Œê°œí˜ì´ì§€(ìµœì¢…)"
excerpt: "í”„ë¡œì íŠ¸ì§„í–‰"

categories:
  - Categories7

tags:
  - [tag1, tag2]

permalink: /categories7/personalproject5-4/

toc: true
toc_sticky: true

date: 2024-10-08
last_modified_at: 2024-10-08
---

# ë¡¤ì±Œë¦°ì§€ì†Œê°œí˜ì´ì§€

ë°°í¬ì‚¬ì´íŠ¸ì£¼ì†Œ : https://champion-project-8wbj.vercel.app/

## ğŸ‘¨â€ğŸ« í”„ë¡œì íŠ¸ ì†Œê°œ

## ë¡¤ ì±Œë¦°ì§€ ìºë¦­í„°ë“¤ì„ ì†Œê°œí•˜ê³  ì•„ì´í…œì„ ê²€ìƒ‰í•  ìˆ˜ ìˆìœ¼ë©° ë¬´ë£Œë¡œ ì‚¬ìš©ê°€ëŠ¥í•œ ì±”í”¼ì–¸ ìºë¦­í„°ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” í˜ì´ì§€

## ğŸš© í”„ë¡œì íŠ¸ ê°œìš”

- **í”„ë¡œì íŠ¸ëª…** &nbsp; :&nbsp; **ë¡¤ì±Œë¦°ì§€**
- **ì§„í–‰ ê¸°ê°„** &nbsp;: &nbsp; **24.09.30 ~ 24.10.07**

í™ˆí˜ì´ì§€

![](https://velog.velcdn.com/images/alice0751/post/8503f37d-8d60-4a16-90eb-fbbbaf868d80/image.png)

ì±”í”¼ì–¸ëª©ë¡ : ì±”í”¼ì–¸ ìºë¦­í„°ë“¤ì„ ì¡°íšŒ, í´ë¦­í•˜ì—¬ ìºë¦­í„°ë³„ ìƒì„¸í˜ì´ì§€ë¡œ ì´ë™ê°€ëŠ¥

![](https://velog.velcdn.com/images/alice0751/post/a96b8a3a-a5de-449b-8ac4-2c05d069c267/image.png)

ì•„ì´í…œëª©ë¡ : ì•„ì´í…œ ëª©ë¡ë“¤ì„ ì¡°íšŒ

![](https://velog.velcdn.com/images/alice0751/post/713345a1-c6fe-45d8-8b07-377e4a914c99/image.png)

ìƒì„¸í˜ì´ì§€ : ìºë¦­í„°ë³„ ìƒì„¸ì •ë³´ ì¡°íšŒ
![](https://velog.velcdn.com/images/alice0751/post/03d45404-d8e0-4a36-ad46-800337a32e56/image.png)

ë¡œí…Œì´ì…˜í˜ì´ì§€ : ì´ë²ˆì£¼ ë¬´ë£Œë¡œ ì‚¬ìš©ê°€ëŠ¥í•œ í˜ì´ì§€ë¥¼ ì¡°íšŒ

## ![](https://velog.velcdn.com/images/alice0751/post/d349fc4d-d87c-4bde-a5e8-277c7ac194e8/image.png)

ì‚¬ìš©í•œ ê¸°ìˆ ìŠ¤íƒ

<div align=Left>
<img src="https://img.shields.io/badge/react-61DAFB?style=for-the-badge&logo=react&logoColor=black">
<img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white">
<img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white">
<img src="https://img.shields.io/badge/typescript-F7DF1E?style=for-the-badge&logo=typescript&logoColor=black">
<img src="https://img.shields.io/badge/reactrouter-CA4245?style=for-the-badge&logo=reactrouter&logoColor=white">
<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/git actions-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://img.shields.io/badge/VSCODE-007ACC?style=for-the-badge&logo=visualstudiocode&logoColor=white">
<img src="https://img.shields.io/badge/VERCEL-007ACC?style=for-the-badge&logo=VERCEL&logoColor=white">
<img src="https://img.shields.io/badge/NEXTJS-green?style=for-the-badge&logo=NEXTJS&logoColor=white">
<img src="https://img.shields.io/badge/TailwindCss-06B6D4?style=for-the-badge&logo=java&logoColor=white">
</div>
---

### Next.jsë¥¼ ì‚¬ìš©í•˜ì—¬ í˜ì´ì§€ ê°œë°œ

1. í”„ë¡œì íŠ¸ êµ¬ì¡°ë¥¼ ë¨¼ì € ë§Œë“¤ì–´ì£¼ì—ˆë‹¤.
   src > app > App router ê´€ë ¨ í´ë”, íŒŒì¼
   src > components ê³µí†µì ìœ¼ë¡œ ì“°ì´ëŠ” ì»´í¬ë„ŒíŠ¸ íŒŒì¼
   src > types íƒ€ì…ì •ì˜
   src> utils api fetch íŒŒì¼

2. App router ê¸°ë°˜ì˜ í˜ì´ì§€ ì„¤ì •
   ë©”ì¸í˜ì´ì§€
   src > app > page.tsx
   Layoutí˜ì´ì§€
   src > app > layout.tsx
   layout íŒŒì¼ì—ëŠ” í˜ì´ì§€ë“¤ë§ˆë‹¤ ê³µí†µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” headerì™€ footerë¥¼ ì‚¬ìš©

```js
export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode,
}>) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        <header className="w-full">
          <nav>
            <ul className="grid grid-cols-4 w-full bg-slate-800 h-10">
              <li className="flex justify-center items-center border border-solid border-gray-500 border-r-0 hover:bg-gray-200 hover:text-black ">
                <Link
                  href="/"
                  className="w-full h-full flex justify-center items-center font-bold"
                >
                  í™ˆ
                </Link>
              </li>
              <li className="flex justify-center items-center border border-solid border-gray-500 border-r-0 hover:bg-gray-200 hover:text-black ">
                <Link
                  href="/champions"
                  className="w-full h-full flex justify-center items-center font-bold"
                >
                  ì±”í”¼ì–¸ ëª©ë¡
                </Link>
              </li>
              <li className="flex justify-center items-center border border-solid border-gray-500 border-r-0 hover:bg-gray-200 hover:text-black ">
                <Link
                  href="/items"
                  className="w-full h-full flex justify-center items-center font-bold"
                >
                  ì•„ì´í…œ ëª©ë¡
                </Link>
              </li>
              <li className="flex justify-center items-center border border-solid border-gray-500 hover:bg-gray-200 hover:text-black ">
                <Link
                  href="/rotation"
                  className="w-full h-full flex justify-center items-center font-bold"
                >
                  ì±”í”¼ì–¸ ë¡œí…Œì´ì…˜
                </Link>
              </li>
            </ul>
          </nav>
        </header>
        {children}
        <footer></footer>
      </body>
    </html>
  );
}
```

4. Riot APIë¥¼ ë°œê¸‰ë°›ê³  .env.localì— í™˜ê²½ë³€ìˆ˜ë¥¼ ì¶”ê°€í•´ì¤€ í›„ .gitignore ì— .envë¥¼ ì¶”ê°€í•´ ë‚´ apiKeyê°€ ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ ë§‰ì•„ì¤Œ

5. ì‚¬ìš©í•˜ëŠ” apië“¤ì˜ jsonë°ì´í„°ë“¤ì„ í™•ì¸í•˜ê³  src/typesì— typeì •ì˜
   ![](https://velog.velcdn.com/images/alice0751/post/c3d23156-0608-4792-b019-a183d7e18d8c/image.png)
   Thunder Clientë¥¼ í™œìš©í•´ jsonë°ì´í„°ë“¤ì„ ë³´ê³  typeë“¤ì„ ì •ì˜í•˜ì˜€ë‹¤.

```ts
xport type Champion = {
  id: string;
  name: string;
  title: string;
  blurb: string;
  info: {
    attack: number;
    defense: number;
    magic: number;
    difficulty: number;
  };
```

### â˜˜ï¸ CSRì—ì„œ Router Handlersì‚¬ìš©í•˜ê¸°

- í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ Router Handlersë¥¼ ì‚¬ìš© (CSR)
- ì„œë²„ ì»´í¬ë„ŒíŠ¸ ì‚¬ì´ë“œ Server Actionsì™€ ë³„ë„ì˜ APIí˜¸ì¶œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì²˜ë¦¬

#### ğŸ’¥ êµ¬í˜„ë°©ë²•

- CSR Route Handlers í™œìš©ë°©ë²• (ì±”í”¼ì–¸ë¡œí…Œì´ì…˜í˜ì´ì§€)
  (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì •ë³´ë³€ê²½ì„ ë°˜ì˜)

app>api>rotation>route.ts

```tsx
import { ChampionRotation } from "@/types/ChampionRotation";
import { NextResponse } from "next/server";

export async function GET() {
  const apiKey = process.env.RIOT_API_KEY;

  if (!apiKey) {
    return NextResponse.json(
      { error: "API Keyê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." },
      { status: 500 }
    );
  }

  try {
    const res = await fetch(
      "https://kr.api.riotgames.com/lol/platform/v3/champion-rotations",
      {
        headers: {
          "X-Riot-Token": apiKey, // headerì— apiKeyì¶”ê°€
        },
      }
    );

    if (!res.ok) {
      return NextResponse.json(
        { error: "ë°ì´í„° ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤." },
        { status: res.status }
      );
    }

    const data: ChampionRotation = await res.json();
    console.log(data);
    return NextResponse.json(data, { status: 200 });
  } catch (error) {
    console.log(error, "championRotation error");
    return NextResponse.json(
      { error: "ì„œë²„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤." },
      { status: 500 }
    );
  }
}
```

### â˜˜ï¸ Server Component (SSR)ì—ì„œ Server Actions ì‚¬ìš©í•˜ê¸°

#### ğŸ’¥ êµ¬í˜„ë°©ë²•

src>utils>serverApi.ts

1. ì±”í”¼ì–¸ ëª©ë¡ë¦¬ìŠ¤íŠ¸ì™€ ì±”í”¼ì–¸ ìƒì„¸ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ë•Œ ë²„ì „ ì •ë³´ê°€ í•„ìš” ë²„ì „ì„ ë¶ˆëŸ¬ì˜¤ëŠ” fetchí•¨ìˆ˜ ì‘ì„±
2. ì±”í”¼ì–¸ ëª©ë¡ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” fetchí•¨ìˆ˜ì‘ì„±
3. ì±”í”¼ì–¸ ìƒì„¸ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” fetchí•¨ìˆ˜ì‘ì„±
   4, item ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” fetchí•¨ìˆ˜ì‘ì„±

```ts
import { Champion } from "@/types/Champion";
import { ChampionDetail } from "@/types/ChampionDetail";
import { Item } from "@/types/Item";

const BASEURL = "https://ddragon.leagueoflegends.com";

// ìµœì‹ ë²„ì „
export async function fetchVersion(): Promise<string> {
  try {
    const fetchVersion = await fetch(`${BASEURL}/api/versions.json`);
    const versionRes = await fetchVersion.json();
    return versionRes[0]; // ìµœì‹  ë²„ì „ ë°˜í™˜
  } catch (error) {
    console.log(error, "ë²„ì „ê°€ì ¸ì˜¤ê¸°ì˜¤ë¥˜");
    return "";
  }
}

// ì±”í”¼ì–¸ì „ì²´ì •ë³´
export async function fetchChampionList(): Promise<Champion[]> {
  const version = await fetchVersion();
  try {
    const res = await fetch(
      `${BASEURL}/cdn/${version}/data/ko_KR/champion.json`,
      {
        cache: "no-store",
      }
    );
    const data = await res.json();
    console.log(data.data);
    return Object.values(data.data);
  } catch (error) {
    console.log(error, "ChampionList Error");
    return [];
  }
}

// ì±”í”¼ì–¸ ìƒì„¸ ì •ë³´
export async function fetchChampionDetail(
  id: string
): Promise<ChampionDetail | null> {
  const version = await fetchVersion();
  try {
    const res = await fetch(
      `${BASEURL}/cdn/${version}/data/ko_KR/champion/${id}.json`
    );
    const data = await res.json();

    return data.data[id];
  } catch (error) {
    console.log(error, "championDetail Error");
    return null;
  }
}

// ì•„ì´í…œì •ë³´
export async function fetchItem(): Promise<Item[]> {
  const version = await fetchVersion();
  try {
    const res = await fetch(
      `${BASEURL}/cdn/${version}/data/ko_KR/item.json` // ì•„ì´í…œ API ì—”ë“œí¬ì¸íŠ¸ ìˆ˜ì •
    );
    const data = await res.json();
    console.log(data.data);
    return Object.values(data.data);
  } catch (error) {
    console.log(error, "ItemFetch Error");
    return [];
  }
}
```

### â˜˜ï¸ apiì •ë³´ ë¶ˆëŸ¬ì™€ì„œ í˜ì´ì§€ì—ì„œ ë°ì´í„° í‘œì‹œí•˜ê¸°

#### - champions ì±”í”¼ì–¸ ëª©ë¡ í˜ì´ì§€

src > app > champions > page.tsx
// ISR(Incremental Static Regernation)ë°©ì‹ìœ¼ë¡œ êµ¬í˜„

- ì •í•´ì§„ ì¼ì • ì‹œê°„ (revalidate) ì— ë”°ë¼ í”„ë¡œì íŠ¸ë¥¼ buildì‹œí‚¬ ë•Œ ë°ì´í„°ì˜ ì •ë³´ê°€ ë³€ê²½ë¨
- Card componentë¥¼ í™œìš©í•˜ì—¬ ì¬ì‚¬ìš©ì„±ì„ ë†’ì„

```tsx
"use server";

import ChampionCard from "@/components/ChampionCard";
import { Champion } from "@/types/Champion";
import { fetchChampionList } from "@/utils/serverApi";

export default async function ChampionPage() {
  const data: Champion[] = await fetchChampionList();

  return (
    <>
      <h1 className="font-extrabold text-3xl text-center mt-12">ì±”í”¼ì–¸ëª©ë¡</h1>
      <div className="w-[80%] grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 mx-auto mt-12 gap-4">
        {data.map((champion) => (
          <ChampionCard key={champion.id} champion={champion} />
        ))}
      </div>
    </>
  );
}

// ë©”íƒ€ë°ì´í„° ì„¤ì •ì„ ìœ„í•œ functionì„ ì¶”ê°€
export async function generateMetadata() {
  return {
    revalidate: 86400,
  };
}
```

#### - champions ì±”í”¼ì–¸ ìƒì„¸ í˜ì´ì§€

- ë©”íƒ€ë°ì´í„°ë¥¼ ì„¤ì •í•˜ì—¬ SEO (ê²€ìƒ‰ì—”ì§„)ì„ í–¥ìƒì‹œí‚´
- SSR
  src > app > champions > [id] > page.tsx

```tsx
// ë©”íƒ€ë°ì´í„° ì„¤ì •
export async function generateMetadata({ params }: Params): Promise<Metadata> {
  const champion: ChampionDetail | null = await fetchChampionDetail(params.id);

  if (!champion) {
    return {
      title: "ì •ë³´ì—†ìŒ",
      description: "ì •ë³´ì—†ìŒ",
      keywords: "League of Legends",
    };
  }
  return {
    title: champion.name,
    description: `Learn more about ${champion.name}, the ${champion.title} in League of Legends.`,
    keywords: `League of Legends, ${champion.name}, ${champion.title}`,
  };
}
```

---

## ğŸ”¥ íŠ¸ëŸ¬ë¸” ìŠ›íŒ…

#### - ì±”í”¼ì–¸ ë¡œí…Œì´ì…˜ í˜ì´ì§€ ( CSR)

: í˜„ì¬ ë¬´ë£Œë¡œ í”Œë ˆì´ ê°€ëŠ¥í•œ ì±”í”¼ì–¸ë“¤ì„ í‘œì‹œ

#### ë¬¸ì œì  ğŸ¥µ

: í˜„ì¬ ë¬´ë£Œë¡œ í”Œë ˆì´ ê°€ëŠ¥í•œ ì±”í”¼ì–¸ë“¤ì„ ì œê³µí•´ì£¼ëŠ” rotation.apiê°€ id ìˆ«ìë§Œì„ ì œê³µí•´ì£¼ê³  ìˆì—ˆë‹¤. ì´ ìˆ«ìë“¤ì„ ì²˜ìŒì—ëŠ” ìƒì„¸í˜ì´ì§€ idì— ë„£ì–´ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í• ë ¤ê³  í–ˆì—ˆë‹¤.
ê²°ë¡ ì ìœ¼ë¡œ ë„ˆë¬´ ë³µì¡í•´ì§€ëŠ” ë¡œì§ì´ì—ˆë‹¤.

#### í•´ê²°ë°©ë²• ğŸ’ª

: ì „ì²´ ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì™€ rotation.apiì— ìˆëŠ” id valueê°’ê³¼ ì „ì²´ì±”í”¼ì–¸ë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” keyê°’ì´ ì¼ì¹˜í•˜ëŠ” ê²ƒë§Œ filterì²˜ë¦¬í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ ì €ì¥í•˜ê³  ì €ì¥í•œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ ë ˆì´ì•„ì›ƒì„ ë§Œë“¤ì–´ì£¼ì—ˆë‹¤.

```tsx

const RotationPage = () => {
  const [rotationData, setRotationData] = useState<Champion[]>([]);
  const [loading, setLoading] = useState<boolean>(true);
  const [error, setError] = useState<string>("");

useEffect(() => {
    const fetchRotationData = async () => {
      try {
        // ì´ë²ˆ ì£¼ ë¡œí…Œì´ì…˜ ë°ì´í„°
        const res = await getChampionRotation();
        const rotationIds = res.freeChampionIds || [];

        // ì „ì²´ ë°ì´í„°
        const championListRes: ChampionListResponse = await fetchChampionList();

        // ë¡œí…Œì´ì…˜ idì™€ ì „ì²´ ë°ì´í„°ì˜ key ë¹„êµí•˜ì—¬ ë§¤ì¹­ë˜ëŠ” ë°ì´í„° ì¶”ì¶œ
        const matchedChampions = Object.keys(championListRes)
          .filter((championKey) =>
            rotationIds.includes(parseInt(championListRes[championKey].key))
          )
          .map((key) => championListRes[key]);

        setRotationData(matchedChampions); // í•„í„°ë§ëœ ë°ì´í„° ì €ì¥
      } catch (error) {
        setError("error");
      } finally {
        setLoading(false);
      }
    };
    fetchRotationData();
  }, []);

```

# ğŸŒŸ localFont ì‚¬ìš©í•˜ê¸°

ì „ì—­ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ ì í•˜ë©´ layout.tsxì—ì„œ
fontë¥¼ ì‚¬ìš©í•˜ëŠ” í˜ì´ì§€ê°€ í•œì •ì ì´ë¼ë©´ ê·¸ í˜ì´ì§€ì—ì„œ ë³€ìˆ˜ì„ ì–¸

ğŸ’¥ ë¬¸ì œì 
: publicí´ë”ì•ˆì— ìˆëŠ” ê±´ importë¥¼ publicì•„ë˜ë¶€í„° í•´ì•¼í•œë‹¤ê³  ì•Œê³  ìˆì–´ì„œ ì•„ë˜ë¡œ importë¥¼ ì§„í–‰í–ˆì—ˆë‹¤. fontê°€ ë¶ˆëŸ¬ì™€ì§€ì§€ ì•Šì•˜ë‹¤.
âœ¨ í•´ê²°ë°©ë²•
: í•´ë‹¹ í˜ì´ì§€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ import ë¥¼ ì‹œì¼œì£¼ë‹ˆ fontê°€ ì œëŒ€ë¡œ ë¶ˆëŸ¬ì™€ì¡Œë‹¤.

src > app > page.tsx

```js

const pretendard = localFont({
  src: "../public/fonts/FreesentationVF.ttf",
  weight: "400",
  variable: "--font-pretendard",
});

export default function Home() {
  return (
    <div className={`w-[70%] mx-auto mt-8 text-center ${pretendard.variable}`}>
      <h1 className="font-logo font-extrabold text-4xl mb-8 text-blue-200">
        <span className="text-pink-200">FIND</span> YOUR
        <span className="text-green-200">CHARACTER</span>
      </h1>
      <div className="w-full mb-8 ">
```

- tailwind.config.ts
  : fontfamilyì— ëª…ì¹­ì¶”ê°€

```js
import type { Config } from "tailwindcss";

const config: Config = {
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      fontFamily: {
        logo: ["var(--font-pretendard)"],
      },
      colors: {
        background: "var(--background)",
        foreground: "var(--foreground)",
      },
    },
  },
  plugins: [],
};
export default config;
```

---

# ğŸŒŸ Image ìµœì í™”

- Next.jsì—ì„œì˜ ë°˜ì‘í˜• ì´ë¯¸ì§€ë¥¼ ì ìš©ì‹œí‚¤ëŠ” ë°©ë²•
  : responsiveì¶”ê°€, widthê°’, heightê°’, altê°’, src ê°’

```js
import Image from "next/image";

<div className="w-full mb-8 ">
  <Image
    src={mainImg}
    layout="responsive" // responsiveì¶”ê°€
    width={1600}
    height={400}
    alt="mainImg"
    className="mb-4"
  />
</div>;
```

---

#### ğŸ¥µ ë¬¸ì œì 

: apië¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” src>utils>serverApi.tsì—ì„œ errorë©”ì„¸ì§€ë¥¼ ì„¤ì •í•´ì¤€ í›„ src>app>champions>page.tsx apië¥¼ ê°€ì ¸ì™€ ë ˆì´ì•„ì›ƒì„ ê·¸ë¦¬ëŠ” í˜ì´ì§€ë“¤ì´ typeì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤.

// serverApi.ts

```tsx
// ìµœì‹ ë²„ì „
export async function fetchVersion(): Promise<string | CustomError> {
  try {
    const fetchVersion = await fetch(`${BASEURL}/api/versions.json`);
    const versionRes = await fetchVersion.json();
    return versionRes[0]; // ìµœì‹  ë²„ì „ ë°˜í™˜
  } catch (error) {
    console.log(error, "Version Error");
    return {
      message: "ìµœì‹  ë²„ì „ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",
    };
  }
}
```

ì˜¤ë¥˜í™”ë©´
![](https://velog.velcdn.com/images/alice0751/post/4c880e5c-a90e-4b3c-ba81-2ae9ce0e3829/image.png)

- ë‚´ê°€ ì˜ˆìƒí•œ ì˜¤ë¥˜ëŠ” ì´ë¯¸ ì•„ë˜ì²˜ëŸ¼ dataì— typeì´ ì„¤ì •ë˜ì–´ìˆëŠ”ë° ì—¬ê¸°ì„œ ì„¤ì •í•œ typeì•ˆì— errorì²˜ë¦¬ëŠ” ì—†ì–´ì„œì˜€ë‹¤.

```tsx

export default async function ChampionPage() {
  const data: ChampionListResponse = await fetchChampionList();

  return (
    <>
      <h1 className="font-extrabold text-3xl text-center mt-12">ì±”í”¼ì–¸ëª©ë¡</h1>
```

- 1ì°¨ í•´ê²°ë°©ë²•
  ë‚´ê°€ ìƒê°í–ˆë˜ ì´ìœ ê°€ ë§ì•˜ê³  dataì˜ typeì§€ì • ë¶€ë¶„ì— CustomErrorë„ í•¨ê»˜ ì¶”ê°€ì‹œì¼œì£¼ë‹ˆ championListí˜ì´ì§€ëŠ” ì—ëŸ¬ê°€ í•´ê²°ë˜ì—ˆë‹¤!

```tsx

export default async function ChampionPage() {
  const data: ChampionListResponse | CustomError = await fetchChampionList();

  return (
    <>
      <h1 className="font-extrabold text-3xl text-center mt-12">ì±”í”¼ì–¸ëª©ë¡</h1>
      <div className="w-[80%] grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 mx-auto mt-12 gap-4">
        <Suspense fallback={<Loading type="page1" />}>
          {Object.values(data).map((champion) => (
            <ChampionCard key={champion.id} champion={champion} />
          ))}
        </Suspense>
      </div>
    </>
  );
```

#### ğŸ¥µ ë˜ ë‹¤ë¥¸ ì—ëŸ¬ ë°œìƒ

- ë‹¤ë¥¸ í˜ì´ì§€ë“¤ë„ ê°™ì€ ë°©ì‹ìœ¼ë¡œ í•´ê²°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤ê³  ìƒê°í–ˆëŠ”ë° ì ìš©ì‹œì¼œë³´ë‹ˆ ë˜ ë‹¤ë¥¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤.
  ![](https://velog.velcdn.com/images/alice0751/post/ff22002b-72f6-478d-b378-6b257e1d2fa7/image.png)

#### âœ¨ í•´ê²°ë°©ë²•

- fetchì—ì„œ ë„˜ì–´ì˜¨ dataë¥¼ itemsë¡œ ì €ì¥ì„ í–ˆì—ˆë‹¤. fetchê°€ ì‹¤íŒ¨í•´ì„œ ë°ì´í„°ê°€ ë„˜ì–´ì˜¬ê²½ìš° messageê°€ ë„˜ì–´ì˜¤ëŠ”ë° ì´ê²ƒì´ ë‚´ê°€ ì§€ì •í•´ì¤€ Item[]ì— ì—†ì–´ì„œ ì˜¤ë¥˜ê°€ ë°œìƒ
- í•´ê²°í•˜ê¸° ìœ„í•´ì„œ dataì•ˆì— messageê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€í•´ì£¼ì—ˆë‹¤ í•´ê²°!

```tsx
const ItemPage = async () => {
  const items: Item[] | CustomError = await fetchItem();

  if ("message" in items) {
    return <ErrorComponent error={items} />;
  }
  return (
    <div>
      <h1 className="text-center mt-12 text-3xl font-extrabold">ì•„ì´í…œ ëª©ë¡</h1>
      <div className="w-[80%] grid grid-cols-4 sm:grid-cols-6 lg:grid-cols-8 mx-auto mt-12 gap-4">
        <Suspense fallback={<Loading type={"page3"} />}>
          {items?.map((item) => (
            <ItemCard key={item.id} item={item} />
          ))}
        </Suspense>
      </div>
    </div>
  );
};
```

---

# ğŸ’¥ Trouble Shooting 2 & ì½”ë“œ ë¦¬í™í† ë§

#### ğŸ¥µ ë¬¸ì œì 

- rotationí˜ì´ì§€ëŠ” client side rendering ë°©ì‹ìœ¼ë¡œ ë Œë”ë§ì„ í•˜ê³  ìˆì—ˆê³  useEffect()ë¥¼ í†µí•´ í˜ì´ì§€ê°€ ì²˜ìŒ ë¡œë“œë  ë•Œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬ë¥¼ í–ˆì—ˆë‹¤. ì´ ê³¼ì •ì—ì„œ useState()ë¥¼ ì‚¬ìš©í•˜ì—¬ loadingê³¼ Errorë¥¼ ë”°ë¡œ ì²˜ë¦¬í•´ì£¼ì—ˆëŠ”ë° useQueryë¥¼ ì‚¬ìš©í•˜ë©´ ê°€ë…ì„±ë¶€ë¶„ê³¼ ê´€ë¦¬ì¸¡ë©´ì—ì„œë„ ë” ìš©ì´í•  ê²ƒ ê°™ì•„ ë¦¬í™í† ë§ í•˜ê²Œ ë˜ì—ˆë‹¤.

#### ìˆœì„œ

1. Tanstack Queryì„¤ì¹˜

```tsx
yarn add @tanstack/react-query

```

2. app>providers.tsxìƒì„± í›„ ë¡œì§ì‘ì„±

```tsx
"use client";

import {
  isServer,
  QueryClient,
  QueryClientProvider,
} from "@tanstack/react-query";

function makeQueryClient() {
  return new QueryClient({
    defaultOptions: {
      queries: {
        staleTime: 60 * 1000,
      },
    },
  });
}

let browserQueryClient: QueryClient | undefined = undefined;

function getQueryClient() {
  if (isServer) {
    return makeQueryClient();
  } else {
    if (!browserQueryClient) browserQueryClient = makeQueryClient();
    return browserQueryClient;
  }
}

export default function Providers({ children }: { children: React.ReactNode }) {
  const queryClient = getQueryClient();

  return (
    <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
  );
}
```

3. CSRì—ì„œ useQueryì‚¬ìš©

- useQueryë¥¼ ì‚¬ìš©í•´ data, isLoading, error ì²˜ë¦¬

```tsx
"use client";

import ChampionCard from "@/components/ChampionCard";
import { Champion, ChampionListResponse } from "@/types/Champion";
import { getChampionRotation } from "@/utils/riotApi";
import { fetchChampionList } from "@/utils/serverApi";
import React from "react";
import { useQuery } from "@tanstack/react-query";
import { CustomError } from "@/types/Error";
import ErrorComponent from "../error";

const fetchRotationData = async (): Promise<Champion[]> => {
  // ì´ë²ˆ ì£¼ ë¡œí…Œì´ì…˜ ë°ì´í„°
  const res = await getChampionRotation();
  const rotationIds = res.freeChampionIds || [];

  // ì „ì²´ ë°ì´í„°
  const championListRes: ChampionListResponse | CustomError =
    await fetchChampionList();

  // CustomError ì²˜ë¦¬
  if ("message" in championListRes) {
    throw new Error("championListì—ëŸ¬ì…ë‹ˆë‹¤");
  }

  // ë¡œí…Œì´ì…˜ idì™€ ì „ì²´ ë°ì´í„°ì˜ key ë¹„êµí•˜ì—¬ ë§¤ì¹­ë˜ëŠ” ë°ì´í„° ì¶”ì¶œ
  return Object.keys(championListRes)
    .filter((championKey) =>
      rotationIds.includes(parseInt(championListRes[championKey].key))
    )
    .map((key) => championListRes[key]);
};

const RotationPage = () => {
  const {
    data: rotationData,
    isLoading,
    error,
  } = useQuery<Champion[], Error>({
    queryKey: ["champitonRotation"],
    queryFn: fetchRotationData,
  });

  if (isLoading) {
    return <div>Loading...</div>;
  }

  if (error) {
    return <ErrorComponent error={error} />;
  }

  return (
    <div>
      <h1 className="font-extrabold text-3xl text-center mt-12 text-red-400">
        ì´ë²ˆì£¼ ë¡œí…Œì´ì…˜ ì±”í”¼ì–¸
      </h1>
      <div className="w-[80%] grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 mx-auto mt-12 gap-4">
        {rotationData?.map((champion) => (
          <ChampionCard key={champion.key} champion={champion} />
        ))}
      </div>
    </div>
  );
};

export default RotationPage;
```

---

# ğŸŒŸ ë°°í¬

![](https://velog.velcdn.com/images/alice0751/post/fb5cdec4-50f9-489b-9e6d-328a36478232/image.png)
ğŸ’¥ ë¬¸ì œì 
: Rotationí˜ì´ì§€ì—ì„œ loadingê³¼ errorë¥¼ useState()ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜ì´ì§€ë¥¼ í‘œì‹œí•´ì£¼ì—ˆëŠ”ë° ë°°í¬í•˜ëŠ” ê³¼ì •ì—ì„œ errorê°€ ì‚¬ìš©ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì˜¤ë¥˜ê°€ ë–´ë‹¤. ë§¨ ì²˜ìŒì€ ì´ì „ì— React ì‘ì—…í–ˆì„ ë•Œì™€ ë¹„ìŠ·í•˜ê²Œ errorë¥¼ ì²˜ë¦¬í–ˆë”ë‹ˆ typescriptê´€ë ¨ ì˜¤ë¥˜ë„ í•¨ê»˜ ë°œìƒí•˜ì˜€ë‹¤.

```js
} catch (error)
       { console.log(error,"errorë°œìƒ") }
      } finally {
        setLoading(false);

```

âœ¨ í•´ê²°ë°©ë²•
: catch (error: unknown) êµ¬ë¬¸ì€ TypeScriptì˜ ê¸°ëŠ¥ìœ¼ë¡œ, ì–´ë–¤ íƒ€ì…ì˜ ê°’ì´ ì˜ˆì™¸ë¡œ ë°œìƒí•  ìˆ˜ ìˆëŠ”ì§€ ì¸ì§€í•˜ê²Œ í•´ì¤€ë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì—ëŸ¬ëŠ” ì—¬ëŸ¬ ì†ŒìŠ¤ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, í•­ìƒ Error íƒ€ì…ì´ ì•„ë‹ ìˆ˜ ìˆë‹¤. instanceof Errorë¥¼ ì‚¬ìš©í•´ ì—ëŸ¬ íƒ€ì…ì„ í™•ì¸í•¨ìœ¼ë¡œì¨, ì¡´ì¬í•˜ì§€ ì•Šì„ ìˆ˜ ìˆëŠ” ì†ì„±ì— ì ‘ê·¼í•˜ë ¤ê³  ì‹œë„í•˜ëŠ” ëŸ°íƒ€ì„ ì—ëŸ¬ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆ
ë‹¤.

```js
      } catch (error: unknown) {
        if (error instanceof Error) setError(error.message);
        else {
          setError("Rotation Error");
        }
      } finally {
        setLoading(false);
      }
```
